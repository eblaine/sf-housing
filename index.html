<html>
    <head>
        <title>Arbolito - a story of the housing crisis</title>
        <link rel="stylesheet" href="box-style.css"/>
        <link rel="stylesheet" href="slider-style.css"/>
        <link rel="stylesheet" href="index.css"/>
        <!-- Makes call to rendering API -->
        <script src="renderer.js"></script>
        <!-- Slider box  -->
        <script src="sliderBox.js"></script>
        
        <!-- Puts an object called `data` in global scope -->
        <!-- TODO: add the static data points to this file (the last will be editable in JS) -->
        <script src="data.js"></script> 
    </head>
    <body>

        <!-- INTRO -->
        <div id="intro_container">
            <div id="intro">
                <div id="arbolito">
                    <p><b>The Town of Arbolito</b></p>
                </div>
                <div id="story">
                    <p>A Story of the Housing Crisis</p>
                </div>
            </div>
            <img class="img-center" src="images/City.png"/><br>
        </div>

        <!-- TEXT -->
        <div class="text">
            <div class="instruction">
                <p><strong>It's the year 1990. You're in the town of Arbolito.</strong></p>
            </div>
            <p> Residents in Arbolito fall into different income brackets. These brackets are defined by the median family income.</p>
            
            <img class="img-center" src="images/SVG/MedianFamilyIncome.svg"/><br>

            <p>
                <img src="images/SVG/square_big_smile_blue1.svg" height="30"/> make 0-30% of the median family income, <br>
                <img src="images/SVG/square_big_smile_blue2.svg" height="30"/> make 31-50% of the median family income, <br>
                <img src="images/SVG/square_big_smile_blue3.svg" height="30"/> make 51-80% of the median family income, and <br>
                <img src="images/SVG/square_big_smile_blue4.svg" height="30"/> make > 80% of the median family income. <br>
            </p>

            <p> Many in Arbolito are <i>rent overburdened</i>. You're considered rent overburdened if you spend <i>over 30%</i> of your income on rent for housing. By that definition, <b>64%</b> of people in Arbolito are rent overburdened.</p>

            <div class="instruction">
                <p><br>In the year 1990, Arbolito looks like this:</p>
            </div>
        </div>

        <!-- GRAPHIC -->
        <div class="graphic">
<!--             <p style="text-align: center;"> Arbolito in 1990... </p> -->
            <br>            
            <div id="1990">
                <script>
                    var rend = new Renderer();
                    var smilePath = 'SVG/square_big_';
                    var frownPath = 'SVG/';


                    // 3rd and 4th render arguments indicate the file path prefix before "blue[1-4].svg", smile and frown, respectively
                    // e.g. the 3rd argument below corresponds to the smiles SVG/square_big_smile[1-4].svg
                    rend.render('1990', data['1990'], smilePath, frownPath); 
                </script>
            </div>
            <br>
        </div>

        <!-- TEXT -->
        <div class="text">
            <p> There’s a sudden burst of internet companies being created in and around Arbolito, and rent prices in Arbolito start increasing. </p>
            <p> You might suspect that this means a <i>higher</i> percentage people in Arbolito are rent overburdened, <i>but actually</i> the demographics of Arbolito start to change. </p>
            <p> The new companies hire many high wage workers, so the percentage of high earners increases. With a higher percentage of people in higher income brackets, the percentage of people that are rent overburdened drops to <b>33%</b>. </p>

            <div class="instruction">
                <p><br>By the year 2000, Arbolito looks like this:</p>
            </div>
        </div>

        <!-- GRAPHIC -->
        <div class="graphic">
            <br>            
            <div id="2000">
                <script>
                    var rend = new Renderer();
                    rend.render('2000', data['2000'], smilePath, frownPath); 
                </script>
            </div>
            <br>
        </div>

        <!-- TEXT -->
        <div class="text">
            <p> To residents, it feels like many people were displaced, and housing prices only continue rising. </p>
            <p> Even though many more people in Arbolito have a higher income, <b>42%</b> are rent overburdened because rent prices have continued rising. </p>

            <div class="instruction">
                <p><br>By the year 2010, Arbolito looks like this:</p>
            </div>
        </div>

        <!-- GRAPHIC -->
        <div class="graphic">
            <br>            
            <div id="2010">
                <script>
                    var rend = new Renderer();
                    rend.render('2010', data['2010'], smilePath, frownPath); 
                </script>
            </div>
            <br>
        </div>


        <!-- TEXT -->
        <div class="text">
            <div class="instruction">
                <p><strong>So, what’s really changing here?</strong></p>
            </div>
            <p> 
                It’s <i>not</i> the fraction of 
                <img src="images/SVG/square_big_smile_blue1.svg" height="24"/>, 
                <img src="images/SVG/square_big_smile_blue2.svg" height="24"/>, and 
                <img src="images/SVG/square_big_smile_blue3.svg" height="24"/>
                struggling to make rent. Arbolito is expensive, and money has always been tight for everyone.
            </p> 
            <p> 
                However, because of the nature of the corporations’ work, they hire more high salary workers than corporations in other industries. This means that the number of
                <img src="images/SVG/square_big_smile_blue4.svg" height="24"/>
                has been on the rise, as is the fraction of them that don’t worry about money at all. 
            </p>
            <p> With an increasing number of high wage workers in Arbolito, the median family income has increased. <i>But</i>, it has increased faster than minimum wage. </p>

            <p> <b> !!! INSERT MEDIAN v MINIMUM GRAPH !!! </b> </p>

            <p> This means that  the gap between 
                <img src="images/SVG/square_big_smile_blue1.svg" height="24"/> and 
                <img src="images/SVG/square_big_smile_blue4.svg" height="24"/>
                has been growing, greatly skewing Arbolito’s wage distribution.
            </p>

            <p>  
                The income distribution in Arbolito is so skewed that all of 
                    <img src="images/SVG/square_big_smile_blue1.svg" height="24"/>, 
                    <img src="images/SVG/square_big_smile_blue2.svg" height="24"/>, and 
                    <img src="images/SVG/square_big_smile_blue3.svg" height="24"/>, and some 
                    <img src="images/SVG/square_big_smile_blue4.svg" height="24"/>,
                are considered ‘low income’.
            </p>

            <p> And, as more corporations are created and move to Arbolito and surrounding areas, more land in Arbolito has been zoned <i>commercially</i> rather than <i>residentially</i>. This means there is limited land in Arbolito to building housing in the first place. </p>

            <p> <b> !!! INSERT LAND ZONING VISUAL !!! </b> </p>

            <p> And, Arbolito has some of the strictest building codes in the country, making the average cost of building a family home in Arbolito <b>$600,000</b>. </p>

            <p> 
                Consequently, average rents in Arbolito (and neighboring towns) are <i>much higher</i> than the national average, leaving an increasing number of 
                    <img src="images/SVG/square_big_smile_blue1.svg" height="24"/>, 
                    <img src="images/SVG/square_big_smile_blue2.svg" height="24"/>, and 
                    <img src="images/SVG/square_big_smile_blue3.svg" height="24"/> 
                rent overburdened.
            </p>

            <p> <b> !!! INSERT RENT AVERAGE GRAPH !!! </b> </p>

            <p> Arbolito's best social scientists are actively studying the housing trends.</p>

            <div class="instruction">
                <p><br> Without intervention, they predict the housing crisis in Arbolito will worsen, and that by the year 2020, Arbolito will look like this:
                </p>
            </div>
        </div>


        <!-- GRAPHIC -->
        <div class="graphic">
            <br>            
            <div id="2018">
                <script>
                    rend.render('2018', data['2018'], smilePath, frownPath); 
                </script>
            </div>
            <br>
        </div>

        <!-- TEXT -->
        <div class="text">
            <div class="instruction">
                <p><strong>But don't lose hope!</strong></p>
                <p><strong>Let's try to raise the minimum wage.</strong></p>
            </div>

            <p>The experts are working on different strategies to fix the problem. Their first idea is to <i>increase minimum wage.</i> </p>
            <p> 
                However, increasing minimum wage can have unexpected consequences. Defying their expectations, their model showed that increasing minimum wage increased housing prices for everyone.
                Even worse, finding affordable housing was just as hard for everyone else. 
            </p>

            <div class="instruction">
                <p><br>Try it out yourself:</p>
            </div>
        </div>

        <!-- INTERACTIVE GRAPHIC -->
        <div class="graphic">
            <div class="slidecontainer">
                <div><b>Minimum wage: $<span id="minwage"></span></b></div>
                <div>$14/hr</div>
                <input type="range" min="14" max="28" value="14" class="slider" id="minwage-slider">
                <div>$28/hr</div>    
                <button class="button" onclick="reset('minwage-slider-box', 'minwage-slider', 14)">RESET</button>            
            </div>
            <div id="minwage-slider-box"></div>
        </div>


        <script>
            var year = '2018';
            function reset(boxId, sliderId, origVal) {
                rend.render(boxId, data[year], smilePath, frownPath); 
                var slider = document.getElementById(sliderId);
                var box = document.getElementById(boxId);
                slider.value = origVal;
                box.resetRents(data[year]);
            }

            // This format should be semi-consistent 
            // Assume input is the slider value. Output should be a % change in housing (0-100)
            // You have access to this.incomes (e.g. this.incomes['low'] is a number)
            // You also have access to the 2018 entry in data.js as this.data
            // Feel free to add other variables needed. For example, here I added minWage to keep track of the previous value
            function minWageUpdate(minWage) {
                //if (!this.minWage) this.minWage = minWage;

                //let prevMinWage = this.minWage;
                this.minWage = minWage;
                let bracketsAffected = ['low']
                if (minWage >=19) {
                    bracketsAffected.push('lowMiddle')
                }

                for (let i = 0; i < bracketsAffected.length; i++) {
                    this.incomes[bracketsAffected[i]] = minWage * 40 * 50;
                }
                
                let housingChange = 0;
                //let minWageFraction = this.data['low']['total'] / 100;
                //let percentChangeIncome = 100 * minWageFraction * (minWage - prevMinWage) / prevMinWage;
                //let housingChange =  (0.4461 * percentChangeIncome);// removed added constant of ~1 because housingCHange was always positive

                document.getElementById('minwage').innerHTML = minWage;
                return housingChange;
            }

            var initialHousingPrice = 25000;
            var mfi = 75600; // updated based on data provided here: https://statisticalatlas.com/place/California/San-Francisco/Household-Income
            var minWageSliderBox = new SliderBox(rend, 'minwage-slider-box',  'minwage-slider', data[year], smilePath, frownPath, minWageUpdate, initialHousingPrice, mfi);
            
            reset('minwage-slider-box', 'minwage-slider', 14);

        </script>


        <!-- TODO: insert more interactive boxes. This should only require editing this file.  -->

    </body>
</html>